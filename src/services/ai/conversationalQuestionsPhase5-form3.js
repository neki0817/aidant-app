/**
 * Phase 5: è£œåŠ©äº‹æ¥­ã®å…·ä½“çš„å†…å®¹ï¼ˆæ§˜å¼3å¯¾å¿œç‰ˆï¼‰
 * æ§˜å¼2ã€Œè£œåŠ©äº‹æ¥­ã§è¡Œã†äº‹æ¥­åã€ã€Œè²©è·¯é–‹æ‹“ç­‰ã®å–çµ„å†…å®¹ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³
 * æ§˜å¼3ã€ŒçµŒè²»æ˜ç´°è¡¨ãƒ»è³‡é‡‘èª¿é”æ–¹æ³•ã€ã®ãŸã‚ã®è³ªå•
 */

export const conversationalQuestionsPhase5Form3 = [
  // === P5-1: è£œåŠ©äº‹æ¥­ã§è¡Œã†äº‹æ¥­åï¼ˆ30æ–‡å­—ä»¥å†…ï¼‰ ===
  {
    id: 'P5-1',
    text: 'è£œåŠ©äº‹æ¥­ã§è¡Œã†äº‹æ¥­åã‚’æ•™ãˆã¦ãã ã•ã„ï¼ˆ30æ–‡å­—ä»¥å†…ï¼‰',
    type: 'text',
    placeholder: 'ä¾‹ï¼šæ–°è¦é¡§å®¢ç²å¾—ã®ãŸã‚ã®åœ°åŸŸåºƒå ±åŠã³ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚·ãƒ§ãƒƒãƒ—ã‚µã‚¤ãƒˆã®ãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«äº‹æ¥­',
    helpText: 'ğŸ’¡ 30æ–‡å­—ä»¥å†…ã§ç°¡æ½”ã«äº‹æ¥­å†…å®¹ã‚’è¡¨ç¾ã—ã¦ãã ã•ã„',
    priority: 1,
    section: 'project_overview',
    formMapping: 'æ§˜å¼2 - è£œåŠ©äº‹æ¥­ã§è¡Œã†äº‹æ¥­å',
    validation: {
      required: true,
      maxLength: 30,
      errorMessage: '30æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„'
    }
  },

  // === P5-2: è³¼å…¥ãƒ»å°å…¥ã™ã‚‹ã‚‚ã®ï¼ˆé …ç›®ã®ãƒªã‚¹ãƒˆï¼‰ ===
  {
    id: 'P5-2',
    text: 'è£œåŠ©é‡‘ã§ä½•ã‚’è³¼å…¥ãƒ»å°å…¥ã™ã‚‹äºˆå®šã§ã™ã‹ï¼Ÿ',
    type: 'textarea',
    placeholder: 'ä¾‹ï¼š\nãƒ»POSãƒ¬ã‚¸ã‚·ã‚¹ãƒ†ãƒ \nãƒ»ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸åˆ¶ä½œ\nãƒ»ãƒãƒ©ã‚·å°åˆ·\nãƒ»çœ‹æ¿åˆ¶ä½œ',
    helpText: 'ğŸ’¡ å„é …ç›®ã¯æ”¹è¡Œã§åŒºåˆ‡ã£ã¦ãã ã•ã„ã€‚è©³ç´°ï¼ˆçµŒè²»åŒºåˆ†ã€è²»ç”¨ï¼‰ã¯æ¬¡ã®è³ªå•ã§èãã¾ã™',
    priority: 1,
    section: 'project_overview',
    formMapping: 'æ§˜å¼3 - çµŒè²»æ˜ç´°è¡¨ - é …ç›®ãƒªã‚¹ãƒˆ',
    validation: {
      required: true,
      minLength: 5,
      errorMessage: 'è³¼å…¥ãƒ»å°å…¥ã™ã‚‹ã‚‚ã®ã‚’æ•™ãˆã¦ãã ã•ã„'
    }
  },

  // === P5-3: å„é …ç›®ã®çµŒè²»åŒºåˆ†ï¼ˆå‹•çš„è³ªå•ï¼‰ ===
  {
    id: 'P5-3',
    text: 'ã€{item}ã€‘ã¯ã©ã®çµŒè²»åŒºåˆ†ã«è©²å½“ã—ã¾ã™ã‹ï¼Ÿ',
    type: 'single_select',
    dynamicQuestion: true, // P5-2ã®å„é …ç›®ã«å¯¾ã—ã¦ç¹°ã‚Šè¿”ã™
    options: [
      { value: 'â‘ æ©Ÿæ¢°è£…ç½®ç­‰è²»', label: 'â‘ æ©Ÿæ¢°è£…ç½®ç­‰è²»ï¼ˆPOSãƒ¬ã‚¸ã€å¨æˆ¿æ©Ÿå™¨ã€è£½é€ è£…ç½®ç­‰ï¼‰' },
      { value: 'â‘¡åºƒå ±è²»', label: 'â‘¡åºƒå ±è²»ï¼ˆãƒãƒ©ã‚·ã€ãƒã‚¹ã‚¿ãƒ¼ã€æ–°èåºƒå‘Šã€SNSåºƒå‘Šç­‰ï¼‰' },
      { value: 'â‘¢ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆé–¢é€£è²»', label: 'â‘¢ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆé–¢é€£è²»ï¼ˆHPåˆ¶ä½œã€ECã‚µã‚¤ãƒˆæ§‹ç¯‰ã€SEOå¯¾ç­–ç­‰ï¼‰' },
      { value: 'â‘£å±•ç¤ºä¼šç­‰å‡ºå±•è²»', label: 'â‘£å±•ç¤ºä¼šç­‰å‡ºå±•è²»ï¼ˆãƒ–ãƒ¼ã‚¹å‡ºå±•æ–™ã€è£…é£¾è²»ç­‰ï¼‰' },
      { value: 'â‘¤æ—…è²»', label: 'â‘¤æ—…è²»ï¼ˆå¸‚å ´èª¿æŸ»ã€è²©è·¯é–‹æ‹“ã®ãŸã‚ã®æ—…è²»ï¼‰' },
      { value: 'â‘¥é–‹ç™ºè²»', label: 'â‘¥é–‹ç™ºè²»ï¼ˆè©¦ä½œå“é–‹ç™ºã€æ–°å•†å“é–‹ç™ºï¼‰' },
      { value: 'â‘¦è³‡æ–™è³¼å…¥è²»', label: 'â‘¦è³‡æ–™è³¼å…¥è²»ï¼ˆå¸‚å ´èª¿æŸ»è³‡æ–™ã€å°‚é–€æ›¸ï¼‰' },
      { value: 'â‘§é›‘å½¹å‹™è²»', label: 'â‘§é›‘å½¹å‹™è²»ï¼ˆé€šè¨³ã€ç¿»è¨³ã€ãƒ‡ã‚¶ã‚¤ãƒ³åˆ¶ä½œï¼‰' },
      { value: 'â‘¨å€Ÿæ–™', label: 'â‘¨å€Ÿæ–™ï¼ˆä¼šå ´å€Ÿæ–™ã€æ©Ÿå™¨ãƒ¬ãƒ³ã‚¿ãƒ«æ–™ï¼‰' },
      { value: 'â‘©è¨­å‚™å‡¦åˆ†è²»', label: 'â‘©è¨­å‚™å‡¦åˆ†è²»ï¼ˆæ—¢å­˜è¨­å‚™ã®æ’¤å»è²»ç”¨ï¼‰' },
      { value: 'â‘ªå§”è¨—ãƒ»å¤–æ³¨è²»', label: 'â‘ªå§”è¨—ãƒ»å¤–æ³¨è²»ï¼ˆã‚³ãƒ³ã‚µãƒ«è²»ç”¨ã€HPåˆ¶ä½œå§”è¨—ï¼‰' }
    ],
    helpText: 'ğŸ’¡ æœ€ã‚‚è¿‘ã„åŒºåˆ†ã‚’é¸æŠã—ã¦ãã ã•ã„',
    priority: 1,
    section: 'expense_breakdown',
    formMapping: 'æ§˜å¼3 - çµŒè²»æ˜ç´°è¡¨ - çµŒè²»åŒºåˆ†',
    validation: {
      required: true
    }
  },

  // === P5-4: å„é …ç›®ã®è²»ç”¨å†…è¨³ï¼ˆå˜ä¾¡Ã—å›æ•°ï¼‰ ===
  {
    id: 'P5-4',
    text: 'ã€{item}ã€‘ã®è²»ç”¨ã‚’æ•™ãˆã¦ãã ã•ã„',
    type: 'expense_breakdown', // ç‰¹æ®Šãªå…¥åŠ›ã‚¿ã‚¤ãƒ—ï¼ˆå˜ä¾¡ãƒ»æ•°é‡ãƒ»å˜ä½ã®3ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰
    dynamicQuestion: true,
    fields: [
      { name: 'unitPrice', label: 'å˜ä¾¡ï¼ˆå††ï¼‰', type: 'number', placeholder: '300000' },
      { name: 'quantity', label: 'æ•°é‡', type: 'number', placeholder: '1' },
      { name: 'unit', label: 'å˜ä½', type: 'text', placeholder: 'å°ã€å¼ã€å›ã€å€‹ã€æšç­‰' }
    ],
    helpText: 'ğŸ’¡ è¦‹ç©æ›¸ãŒã‚ã‚‹å ´åˆã¯è¦‹ç©é¡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆæ¦‚ç®—ã§ã‚‚å¯ï¼‰',
    priority: 1,
    section: 'expense_breakdown',
    formMapping: 'æ§˜å¼3 - çµŒè²»æ˜ç´°è¡¨ - çµŒè²»å†…è¨³ï¼ˆå˜ä¾¡Ã—å›æ•°ï¼‰',
    validation: {
      required: true,
      minUnitPrice: 1000, // æœ€ä½1,000å††
      maxUnitPrice: 10000000, // æœ€å¤§1,000ä¸‡å††
      minQuantity: 1,
      maxQuantity: 1000
    }
  },

  // === P5-5: å„é …ç›®ã®ç¨è¾¼ãƒ»ç¨æŠœ ===
  {
    id: 'P5-5',
    text: 'ã€{item}ã€‘ã®è²»ç”¨ã¯ç¨è¾¼ã§ã™ã‹ï¼Ÿç¨æŠœã§ã™ã‹ï¼Ÿ',
    type: 'single_select',
    dynamicQuestion: true,
    options: [
      { value: 'ç¨è¾¼', label: 'ç¨è¾¼' },
      { value: 'ç¨æŠœ', label: 'ç¨æŠœ' }
    ],
    helpText: 'ğŸ’¡ è¦‹ç©æ›¸ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹é€šã‚Šã«é¸æŠã—ã¦ãã ã•ã„',
    priority: 1,
    section: 'expense_breakdown',
    formMapping: 'æ§˜å¼3 - çµŒè²»æ˜ç´°è¡¨ - ç¨è¾¼ãƒ»ç¨æŠœ',
    validation: {
      required: true
    }
  },

  // === P5-6: å®Ÿæ–½æ™‚æœŸï¼ˆé–‹å§‹ï¼‰ ===
  {
    id: 'P5-6',
    text: 'ã„ã¤é ƒã‹ã‚‰äº‹æ¥­ã‚’é–‹å§‹ã™ã‚‹äºˆå®šã§ã™ã‹ï¼Ÿ',
    type: 'text',
    placeholder: 'ä¾‹ï¼š2025å¹´6æœˆã€æ¥æœˆã€3ãƒ¶æœˆå¾Œ',
    helpText: 'ğŸ’¡ ãŠãŠã‚ˆãã®æ™‚æœŸã§æ§‹ã„ã¾ã›ã‚“',
    priority: 1,
    section: 'schedule',
    formMapping: 'æ§˜å¼2 - è²©è·¯é–‹æ‹“ç­‰ã®å–çµ„å†…å®¹ - é–‹å§‹æ™‚æœŸ',
    validation: {
      required: true,
      minLength: 3,
      errorMessage: 'é–‹å§‹æ™‚æœŸã‚’æ•™ãˆã¦ãã ã•ã„'
    }
  },

  // === P5-7: å®Ÿæ–½æ™‚æœŸï¼ˆå®Œäº†ï¼‰ ===
  {
    id: 'P5-7',
    text: 'ã„ã¤é ƒã¾ã§ã«å®Œäº†ã™ã‚‹äºˆå®šã§ã™ã‹ï¼Ÿ',
    type: 'text',
    placeholder: 'ä¾‹ï¼š2025å¹´12æœˆã€åŠå¹´å¾Œã€1å¹´å¾Œ',
    helpText: 'ğŸ’¡ ãŠãŠã‚ˆãã®æ™‚æœŸã§æ§‹ã„ã¾ã›ã‚“',
    priority: 1,
    section: 'schedule',
    formMapping: 'æ§˜å¼2 - è²©è·¯é–‹æ‹“ç­‰ã®å–çµ„å†…å®¹ - å®Œäº†æ™‚æœŸ',
    validation: {
      required: true,
      minLength: 3,
      errorMessage: 'å®Œäº†æ™‚æœŸã‚’æ•™ãˆã¦ãã ã•ã„'
    }
  },

  // === P5-8: æ–°è¦é¡§å®¢æ•°ã®è¦‹è¾¼ã¿ï¼ˆäº‹å®Ÿãƒ™ãƒ¼ã‚¹ï¼‰ ===
  {
    id: 'P5-8',
    text: 'ã“ã®äº‹æ¥­ã§ã€æ–°è¦ã®ãŠå®¢æ§˜ã¯æœˆã«ä½•çµ„ï¼ˆä½•äººï¼‰ãã‚‰ã„å¢—ãˆã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ',
    type: 'number',
    placeholder: 'ä¾‹ï¼š20',
    suffix: 'çµ„ï¼ˆäººï¼‰',
    helpText: 'ğŸ’¡ ãŠãŠã‚ˆãã®è¦‹è¾¼ã¿ã§æ§‹ã„ã¾ã›ã‚“',
    priority: 1,
    section: 'expected_results',
    formMapping: 'æ§˜å¼2 - è²©è·¯é–‹æ‹“ç­‰ã®å–çµ„å†…å®¹ - æ–°è¦é¡§å®¢å¢—åŠ è¦‹è¾¼ã¿',
    validation: {
      required: true,
      min: 0,
      max: 10000
    }
  },

  // === P5-9: ãƒªãƒ”ãƒ¼ãƒˆç‡ã®è¦‹è¾¼ã¿ï¼ˆäº‹å®Ÿãƒ™ãƒ¼ã‚¹ï¼‰ ===
  {
    id: 'P5-9',
    text: 'æ–°ã—ãæ¥ãŸãŠå®¢æ§˜ã®ã†ã¡ã€ä½•å‰²ãã‚‰ã„ãŒãƒªãƒ”ãƒ¼ã‚¿ãƒ¼ã«ãªã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ',
    type: 'number',
    placeholder: 'ä¾‹ï¼š30',
    suffix: '%',
    helpText: 'ğŸ’¡ ã“ã‚Œã¾ã§ã®çµŒé¨“ã‹ã‚‰ã€ãŠãŠã‚ˆãã®å‰²åˆã‚’æ•™ãˆã¦ãã ã•ã„',
    priority: 2,
    section: 'expected_results',
    formMapping: 'æ§˜å¼2 - è²©è·¯é–‹æ‹“ç­‰ã®å–çµ„å†…å®¹ - ãƒªãƒ”ãƒ¼ãƒˆç‡',
    condition: (answers) => {
      return answers['P5-8'] && answers['P5-8'] > 0;
    },
    validation: {
      required: true,
      min: 0,
      max: 100
    }
  },

  // === P5-10: è£œåŠ©é‡‘ãŒå¿…è¦ãªç†ç”±ï¼ˆç°¡æ½”ã«ï¼‰ ===
  {
    id: 'P5-10',
    text: 'ãªãœã“ã®è£œåŠ©é‡‘ãŒå¿…è¦ã§ã™ã‹ï¼Ÿ',
    type: 'single_select',
    options: [
      { value: 'è‡ªå·±è³‡é‡‘ã ã‘ã§ã¯æŠ•è³‡ãŒé›£ã—ã„', label: 'è‡ªå·±è³‡é‡‘ã ã‘ã§ã¯æŠ•è³‡ãŒé›£ã—ã„' },
      { value: 'å£²ä¸Šæ¸›å°‘ã§è³‡é‡‘ç¹°ã‚ŠãŒå³ã—ã„', label: 'å£²ä¸Šæ¸›å°‘ã§è³‡é‡‘ç¹°ã‚ŠãŒå³ã—ã„' },
      { value: 'æ—©æœŸã«å®Ÿæ–½ã—ãŸã„', label: 'æ—©æœŸã«å®Ÿæ–½ã—ãŸã„' },
      { value: 'æŠ•è³‡ãƒªã‚¹ã‚¯ã‚’è»½æ¸›ã—ãŸã„', label: 'æŠ•è³‡ãƒªã‚¹ã‚¯ã‚’è»½æ¸›ã—ãŸã„' },
      { value: 'ãã®ä»–', label: 'ãã®ä»–' }
    ],
    helpText: 'ğŸ’¡ æœ€ã‚‚è¿‘ã„ç†ç”±ã‚’é¸ã‚“ã§ãã ã•ã„',
    priority: 2,
    section: 'subsidy_necessity',
    formMapping: 'æ§˜å¼2 - è²©è·¯é–‹æ‹“ç­‰ã®å–çµ„å†…å®¹ - è£œåŠ©é‡‘ã®å¿…è¦æ€§',
    validation: {
      required: true
    }
  }
];

/**
 * P5-2ã®å›ç­”ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦é …ç›®ãƒªã‚¹ãƒˆã‚’å–å¾—
 */
export function parseExpenseItems(p5_2_answer) {
  if (!p5_2_answer) return [];

  // æ”¹è¡Œã§åˆ†å‰²ã—ã€å…ˆé ­ã®ã€Œãƒ»ã€ã€Œ-ã€ã€Œ*ã€ã‚’é™¤å»
  const items = p5_2_answer
    .split('\n')
    .map(line => line.trim())
    .filter(line => line.length > 0)
    .map(line => line.replace(/^[ãƒ»\-\*]\s*/, ''));

  return items;
}

/**
 * å‹•çš„è³ªå•ã‚’ç”Ÿæˆï¼ˆP5-3, P5-4, P5-5ï¼‰
 */
export function generateDynamicQuestions(baseQuestion, items) {
  return items.map(item => ({
    ...baseQuestion,
    id: `${baseQuestion.id}-${item}`,
    text: baseQuestion.text.replace('{item}', item),
    itemName: item // é …ç›®åã‚’ä¿å­˜
  }));
}

/**
 * Phase 5ã®ã‚«ãƒ†ã‚´ãƒªå®šç¾©
 */
export const phase5Categories = {
  project_overview: {
    title: 'äº‹æ¥­ã®æ¦‚è¦',
    description: 'è£œåŠ©äº‹æ¥­ã®åç§°ã¨å®Ÿæ–½å†…å®¹'
  },
  expense_breakdown: {
    title: 'çµŒè²»æ˜ç´°',
    description: 'è³¼å…¥ãƒ»å°å…¥ã™ã‚‹è¨­å‚™ãƒ»ã‚·ã‚¹ãƒ†ãƒ ã®è©³ç´°'
  },
  schedule: {
    title: 'å®Ÿæ–½ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«',
    description: 'äº‹æ¥­ã®å®Ÿæ–½æ™‚æœŸ'
  },
  expected_results: {
    title: 'æœŸå¾…ã™ã‚‹åŠ¹æœ',
    description: 'å£²ä¸Šå¢—åŠ è¦‹è¾¼ã¿ã¨æ ¹æ‹ '
  },
  subsidy_necessity: {
    title: 'è£œåŠ©é‡‘ã®å¿…è¦æ€§',
    description: 'ãªãœè£œåŠ©é‡‘ãŒå¿…è¦ã‹'
  }
};

export default conversationalQuestionsPhase5Form3;
